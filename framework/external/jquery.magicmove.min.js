(function(e){var t={selector:"> *",visible:{opacity:1,transform:"scale(1)"},hidden:{opacity:0,transform:"scale(0.001)"}};var n=e.expando+"mm";var r=function(t){var n=[];this.parent().css({position:"relative"});this.each(function(){n.push(e(this).position())});this.each(function(t){e(this).css(e.extend({position:"absolute"},n[t]))});return this};var i=function(){return this.css({position:"",top:"",left:""})};var s=function(t,n){var r={easing:"linear",duration:400};n=e.extend({},r,n);var i=["all",n.duration+"ms",n.easing].join(" ");t=e.extend({transition:i},t);var s=function(){e(this).css("transition","");e(this).dequeue()};return this.queue(function(){setTimeout(e.proxy(s,this),n.duration);e(this).css(t)})};var o=function(){return this.each(function(){var e=this.offsetTop})};var u=function(e,t){return e.filter(function(){var e=this;return!t.filter(function(){return this[n]==e[n]})[0]})};var a=function(e,t){return e.filter(function(){var e=this;return t.filter(function(){return this[n]==e[n]})[0]})};var f=function(f,l){if(typeof f==="function"){l=f;f={}}f=e.extend({},t,f);var c=[];var h=e(this);var p=h.find(f.selector);var d=h.clone(true,true);var v=d.find(f.selector);p.each(function(e){this[n]=v[e][n]=e});d.css({position:"absolute",left:"-1000px",top:"-1000px"}).appendTo("body");l.call(d,d,f);$tNodes=d.find(f.selector);var m=u($tNodes,p);var g=u(p,$tNodes);var y=a($tNodes,p);r.call(p);y.each(function(){var t=e(p[this[n]]);var r=e(this);var i=r.position();if(r.is(":visible")&&t.is(":hidden")){e.extend(i,f.visible)}else if(r.is(":hidden")&&t.is(":visible")){e.extend(i,f.hidden);t.promise().done(function(){t.hide()})}s.call(t,i,f);c.push(t.promise())});m.each(function(){var t=e(this);var n=p.eq(t.index());var i=r.call(t).clone();i.css(f.hidden);i.insertBefore(n);o.call(i);s.call(i,f.visible,f);c.push(i.promise())});g.each(function(){var t=e(p[this[n]]);s.call(t,f.hidden,f);t.promise().done(function(){t.remove()});c.push(t.promise())});d.remove();var b=e.when.apply(e,c);return b.done(function(){i.call(h.find(f.selector))})};e.fn.magicMove=function(e,t){var n=this;return n.queue(function(){var r=f.call(n,e,t);r.done(function(){n.dequeue()})})}})(jQuery)